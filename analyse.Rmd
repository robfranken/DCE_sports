---
title: "Multinomial logit model"
bibliography: references.bib
date: "Last compiled on `r format(Sys.time(), '%B, %Y')`"
output: 
  html_document:
    css: tweaks.css
    toc:  true
    toc_float: true
    number_sections: true
    toc_depth: 1
    code_folding: show
    code_download: yes
---

```{r, globalsettings, echo=FALSE, warning=FALSE, results='hide'}
library(knitr)
knitr::opts_chunk$set(echo = TRUE)
opts_chunk$set(tidy.opts=list(width.cutoff=100),tidy=TRUE, warning = FALSE, message = FALSE,comment = "#>", cache=TRUE, class.source=c("test"), class.output=c("test3"))
options(width = 100)
rgl::setupKnitr()

colorize <- function(x, color) {sprintf("<span style='color: %s;'>%s</span>", color, x) }
```


```{r klippy, echo=FALSE, include=TRUE}
klippy::klippy(position = c('top', 'right'))
#klippy::klippy(color = 'darkred')
#klippy::klippy(tooltip_message = 'Click to copy', tooltip_success = 'Done')
```


---  


To copy the code, click the button in the upper right corner of the code-chunks.

# Getting started

## clean up

```{r, results='hide'}
rm(list=ls())
gc()
```

<br>

## general custom functions

- `fpackage.check`: Check if packages are installed (and install if not) in R
- `fsave`: Function to save data with time stamp in correct directory
- `fload`: Function to load R-objects under new names

```{r, results='hide', message=FALSE, warning=FALSE}
fpackage.check <- function(packages) {
    lapply(packages, FUN = function(x) {
        if (!require(x, character.only = TRUE)) {
            install.packages(x, dependencies = TRUE)
            library(x, character.only = TRUE)
        }
    })
}

fsave <- function(x, file, location = "./data/processed/", ...) {
    if (!dir.exists(location))
        dir.create(location)
    datename <- substr(gsub("[:-]", "", Sys.time()), 1, 8)
    totalname <- paste(location, datename, file, sep = "")
    print(paste("SAVED: ", totalname, sep = ""))
    save(x, file = totalname)
}


fload  <- function(fileName){
  load(fileName)
  get(ls()[ls() != "fileName"])
}
```

<br>

## necessary packages

- `tidyverse`: data wrangling
- `mlogit`: multinomial logit
- `knitr`: generating tables
- `kableExtra`: manipulating tables

```{r, results='hide', message=FALSE, warning=FALSE}
packages = c("tidyverse", "mlogit", "knitr", "kableExtra", "stargazer")
fpackage.check(packages)

```

<br>

## load in mlogit data
```{r, eval=F}
#get todays date:
today <- gsub("-", "", Sys.Date())

io_ml <- fload(paste0("./data/processed/",today,"io_ml.RData"))

rm (today)
```

<br>

# run model

```{r, eval=FALSE}
#main
m1 <- mlogit(choice ~ comparison + knowledge + companionship + encouragement | 0, data = io_ml)
#summary(m1)

#interaction with gender
m2 <- mlogit(choice ~ comparison + knowledge + companionship + encouragement + comparisonlow.FEMALE + comparisonmedium.FEMALE + knowledgelow.FEMALE + knowledgemedium.FEMALE + companionshiplow.FEMALE + companionshipmedium.FEMALE + encouragementlow.FEMALE + encouragementmedium.FEMALE | 0, data = io_ml)
#summary(m2)

#interaciton with active (yes/no)
m3 <- mlogit(choice ~ comparison + knowledge + companionship + encouragement + comparisonlow.ACTIVE + comparisonmedium.ACTIVE + knowledgelow.ACTIVE + knowledgemedium.ACTIVE + companionshiplow.ACTIVE + companionshipmedium.ACTIVE + encouragementlow.ACTIVE + encouragementmedium.ACTIVE | 0, data = io_ml)
#summary(m3)

#save outpput in html table
##stargazer(m1,m2,m3, type="text")

stargazer(m1,m2,m3, 
          type="html", 
          title="Multinomial logit model results", 
          dep.var.labels = "Sports partner choice",
          covariate.labels = c("does not like to compare sports performances", "somewhat likes to compare sports performances", 
                               "knows less than you about effective training and the right technique", "knows as much as you about effective training and the right technique",
                               "exercises purposefully and seriously", "wants a combination of social interaction and purposeful training",
                               "never encourages you", "sometimes encourages you", 
                               paste0(c("does not like to compare sports performances", "somewhat likes to compare sports performances", 
                               "knows less than you about effective training and the right technique", "knows as much as you about effective training and the right technique",
                               "exercises purposefully and seriously", "wants a combination of social interaction and purposeful training",
                               "never encourages you", "sometimes encourages you"),"*female"),
                               paste0(c("does not like to compare sports performances", "somewhat likes to compare sports performances", 
                               "knows less than you about effective training and the right technique", "knows as much as you about effective training and the right technique",
                               "exercises purposefully and seriously", "wants a combination of social interaction and purposeful training",
                               "never encourages you", "sometimes encourages you"),"*active")),
          single.row=FALSE, align = TRUE, digits=2, out = "./results/models.html")
```




<br>


# output


```{r, echo=FALSE}
htmltools::includeHTML("./results/models.html")

```

<!----

<br>

### observations

1. Comparison: respondents prefer a sports partner who places an appropriate amount of emphasis on social comparison â€” not too much and not too little.

2. Knowledge: respondents don't want a sports partner that knows less about training and technique than themselves. 

3. Social: respondents seem to favor someone who combines having fun and being goal-oriented while training; however, they appear to prefer exercising for fun over doing so solely seriously

4. Encouragement: respondents prefer a sports partner that regularly encourages them.



Both genders won't choose a sports partner who places great emphasis on social comparison and competition. However, males generally prefer a sports partner who places some emphasis on social comparison, whereas females show no significant difference in their preference for a partner who places little or no emphasis on social comparison. In line with the idea that male sports participation is driven to a greater extent by status/competition than females (who were expected to be more driven by affiliation, which is not apparent from the model results).


Similar pattern: those currently active prefer sports partners who place an appropriate amount of emphasis on social comparison (not too much, not too little). Those currently inactive do not: they dislike great emphasis on social comparison/competition, but do not prefer a little over no emphasis on social comparison. Again, in line with the expectation. Currently, no notable difference in importance of social-emotional motives (i.e., encouragement, affiliation).

Note that the genders do hardly differ in whether or not they are currently active [r(female, active) < -0.02].

--->




